{
  "version": 3,
  "sources": ["../bundle-OXXgyv/checked-fetch.js", "../../../worker.ts", "../../../../../../../Users/manju/.npm/_npx/32026684e21afda6/node_modules/wrangler/templates/middleware/middleware-ensure-req-body-drained.ts", "../../../../../../../Users/manju/.npm/_npx/32026684e21afda6/node_modules/wrangler/templates/middleware/middleware-miniflare3-json-error.ts", "../bundle-OXXgyv/middleware-insertion-facade.js", "../../../../../../../Users/manju/.npm/_npx/32026684e21afda6/node_modules/wrangler/templates/middleware/common.ts", "../bundle-OXXgyv/middleware-loader.entry.ts"],
  "sourceRoot": "/Applications/Projects/social-media-manager/backend/.wrangler/tmp/dev-mhaeZd",
  "sourcesContent": ["const urls = new Set();\n\nfunction checkURL(request, init) {\n\tconst url =\n\t\trequest instanceof URL\n\t\t\t? request\n\t\t\t: new URL(\n\t\t\t\t\t(typeof request === \"string\"\n\t\t\t\t\t\t? new Request(request, init)\n\t\t\t\t\t\t: request\n\t\t\t\t\t).url\n\t\t\t\t);\n\tif (url.port && url.port !== \"443\" && url.protocol === \"https:\") {\n\t\tif (!urls.has(url.toString())) {\n\t\t\turls.add(url.toString());\n\t\t\tconsole.warn(\n\t\t\t\t`WARNING: known issue with \\`fetch()\\` requests to custom HTTPS ports in published Workers:\\n` +\n\t\t\t\t\t` - ${url.toString()} - the custom port will be ignored when the Worker is published using the \\`wrangler deploy\\` command.\\n`\n\t\t\t);\n\t\t}\n\t}\n}\n\nglobalThis.fetch = new Proxy(globalThis.fetch, {\n\tapply(target, thisArg, argArray) {\n\t\tconst [request, init] = argArray;\n\t\tcheckURL(request, init);\n\t\treturn Reflect.apply(target, thisArg, argArray);\n\t},\n});\n", "/**\n * This file contains the Cloudflare Worker logic.\n * In a real deployment, this would be your `src/index.ts` in the Worker project.\n * It handles the API endpoints and the Queue processing.\n */\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n// Mock types for Cloudflare environment\ninterface Env {\n  DB: any; // D1Database\n  BUCKET: any; // R2Bucket\n  QUEUE: any; // Queue\n  META_APP_ID: string;\n  META_APP_SECRET: string;\n  META_REDIRECT_URI: string;\n  FRONTEND_URL: string; // URL where this React app is hosted\n  API_SECRET: string; // To protect cron/endpoints\n  ENCRYPTION_KEY: string; // 32-byte hex string or secret passphrase for AES-GCM\n}\n\n// -----------------------------------------------------------------------------\n// HELPER: Encryption / Decryption\n// -----------------------------------------------------------------------------\nasync function getCryptoKey(secret: string): Promise<CryptoKey> {\n  const enc = new TextEncoder();\n  // Derive a key from the secret string using PBKDF2\n  const keyMaterial = await crypto.subtle.importKey(\n    'raw',\n    enc.encode(secret),\n    { name: 'PBKDF2' },\n    false,\n    ['deriveKey']\n  );\n\n  return crypto.subtle.deriveKey(\n    {\n      name: 'PBKDF2',\n      salt: enc.encode('social_sync_salt_v1'), // In prod, use a random salt stored with data, but fixed here for simplicity\n      iterations: 100000,\n      hash: 'SHA-256',\n    },\n    keyMaterial,\n    { name: 'AES-GCM', length: 256 },\n    false,\n    ['encrypt', 'decrypt']\n  );\n}\n\nasync function encryptToken(text: string, secret: string): Promise<string> {\n  if (!text) return '';\n  try {\n    const key = await getCryptoKey(secret);\n    const iv = crypto.getRandomValues(new Uint8Array(12));\n    const encoded = new TextEncoder().encode(text);\n\n    const encrypted = await crypto.subtle.encrypt(\n      { name: 'AES-GCM', iv },\n      key,\n      encoded\n    );\n\n    // Convert buffer to hex string\n    const toHex = (buf: ArrayBuffer) =>\n      Array.from(new Uint8Array(buf))\n        .map((b) => b.toString(16).padStart(2, '0'))\n        .join('');\n\n    // Format: iv:ciphertext\n    return `${toHex(iv.buffer)}:${toHex(encrypted)}`;\n  } catch (e) {\n    console.error('Encryption failed', e);\n    throw e;\n  }\n}\n\nasync function decryptToken(\n  cipherText: string,\n  secret: string\n): Promise<string> {\n  // If not in iv:ciphertext format, return as is (backward compatibility or error)\n  if (!cipherText || !cipherText.includes(':')) return cipherText;\n\n  try {\n    const [ivHex, dataHex] = cipherText.split(':');\n    const key = await getCryptoKey(secret);\n\n    const fromHex = (hex: string) =>\n      new Uint8Array(\n        (hex.match(/.{1,2}/g) || []).map((byte) => parseInt(byte, 16))\n      );\n\n    const decrypted = await crypto.subtle.decrypt(\n      { name: 'AES-GCM', iv: fromHex(ivHex) },\n      key,\n      fromHex(dataHex)\n    );\n\n    return new TextDecoder().decode(decrypted);\n  } catch (e) {\n    console.error('Decryption failed', e);\n    throw new Error('Failed to decrypt token');\n  }\n}\n\n// -----------------------------------------------------------------------------\n// HELPER: Caption Processor (Anti-Spam Logic)\n// -----------------------------------------------------------------------------\n\n// Helper to shuffle an array (Fisher-Yates)\nfunction shuffleArray<T>(array: T[]): T[] {\n  const arr = [...array];\n  for (let i = arr.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1));\n    [arr[i], arr[j]] = [arr[j], arr[i]];\n  }\n  return arr;\n}\n\nfunction processCaption(base: string, accountName: string): string {\n  // 1. Spintax Processing: {Option A|Option B}\n  let caption = base.replace(/\\{([^{}]+)\\}/g, (_match, group) => {\n    const options = group.split('|');\n    return options[Math.floor(Math.random() * options.length)];\n  });\n\n  // 2. Extract and Shuffle Hashtags\n  // Regex finds words starting with #.\n  const hashtagRegex = /#[\\w\\u0590-\\u05ff]+/g;\n  const foundHashtags = caption.match(hashtagRegex) || [];\n\n  // Remove hashtags from the main text to re-append them later in random order\n  let cleanCaption = caption.replace(hashtagRegex, '').trim();\n\n  // Shuffle the tags\n  const shuffledTags = shuffleArray(foundHashtags).join(' ');\n\n  // 3. Emoji Injection (Add variation to avoid duplicate content detection)\n  const emojis = [\n    '\u2728',\n    '\uD83D\uDE80',\n    '\uD83D\uDD25',\n    '\uD83D\uDCAF',\n    '\u2705',\n    '\uD83D\uDCE3',\n    '\uD83D\uDC47',\n    '\uD83D\uDC40',\n    '\uD83C\uDF1F',\n    '\uD83D\uDCAB',\n    '\u26A1',\n    '\uD83D\uDCCD',\n  ];\n\n  // Pick 1-2 random emojis\n  const numEmojis = Math.floor(Math.random() * 2) + 1;\n  const selectedEmojis = shuffleArray(emojis).slice(0, numEmojis);\n\n  // Inject emojis: Randomly at start, end of text, or replacing double newlines\n  const injectionStrategy = Math.random();\n\n  if (injectionStrategy < 0.33) {\n    // Prepend\n    cleanCaption = `${selectedEmojis.join(' ')} ${cleanCaption}`;\n  } else if (injectionStrategy < 0.66) {\n    // Append to text body\n    cleanCaption = `${cleanCaption} ${selectedEmojis.join(' ')}`;\n  } else {\n    // If there are paragraphs, insert between them\n    cleanCaption = cleanCaption.replace(/\\n\\n/g, `\\n${selectedEmojis[0]}\\n`);\n  }\n\n  // 4. Final Assembly\n  // Add Account Name Variation (invisible separation or explicit) to ensure uniqueness\n  // Adding the shuffled hashtags at the end\n  let finalPost = cleanCaption;\n\n  // Add hashtags if they existed\n  if (shuffledTags.length > 0) {\n    finalPost += `\\n\\n${shuffledTags}`;\n  }\n\n  // 10% chance to add location footer for extra uniqueness\n  if (Math.random() > 0.9) {\n    finalPost += `\\n\uD83D\uDCCD ${accountName}`;\n  }\n\n  return finalPost;\n}\n\n// -----------------------------------------------------------------------------\n// HELPER: Password Hashing (bcrypt-like using PBKDF2)\n// -----------------------------------------------------------------------------\n\nasync function hashPassword(\n  password: string,\n  secretKey: string\n): Promise<string> {\n  const encoder = new TextEncoder();\n  const salt = crypto.getRandomValues(new Uint8Array(16));\n\n  const keyMaterial = await crypto.subtle.importKey(\n    'raw',\n    encoder.encode(password),\n    { name: 'PBKDF2' },\n    false,\n    ['deriveBits']\n  );\n\n  const derivedBits = await crypto.subtle.deriveBits(\n    {\n      name: 'PBKDF2',\n      salt: salt,\n      iterations: 100000,\n      hash: 'SHA-256',\n    },\n    keyMaterial,\n    256\n  );\n\n  const hashArray = Array.from(new Uint8Array(derivedBits));\n  const hashHex = hashArray\n    .map((b) => b.toString(16).padStart(2, '0'))\n    .join('');\n\n  // Convert salt correctly\n  const saltHex = Array.from(salt)\n    .map((b) => b.toString(16).padStart(2, '0'))\n    .join('');\n\n  // Return as: iterations:salt:hash\n  return `100000:${saltHex}:${hashHex}`;\n}\n\nasync function verifyPassword(\n  password: string,\n  storedHash: string,\n  secretKey: string\n): Promise<boolean> {\n  try {\n    const parts = storedHash.split(':');\n    if (parts.length !== 3) return false;\n\n    const [iterations, saltHex, hashPart] = parts;\n    const encoder = new TextEncoder();\n\n    const keyMaterial = await crypto.subtle.importKey(\n      'raw',\n      encoder.encode(password),\n      { name: 'PBKDF2' },\n      false,\n      ['deriveBits']\n    );\n\n    const derivedBits = await crypto.subtle.deriveBits(\n      {\n        name: 'PBKDF2',\n        salt: Uint8Array.from(\n          saltHex.match(/.{1,2}/g)!.map((byte) => parseInt(byte, 16))\n        ),\n        iterations: parseInt(iterations),\n        hash: 'SHA-256',\n      },\n      keyMaterial,\n      256\n    );\n\n    const hashArray = Array.from(new Uint8Array(derivedBits));\n    const computedHash = hashArray\n      .map((b) => b.toString(16).padStart(2, '0'))\n      .join('');\n\n    return computedHash === hashPart;\n  } catch (e) {\n    console.error('Password verification failed', e);\n    return false;\n  }\n}\n\n// -----------------------------------------------------------------------------\n// HELPER: Initialize Admin User (First Run)\n// -----------------------------------------------------------------------------\n\nasync function ensureAdminUser(env: Env, secretKey: string) {\n  try {\n    // Ensure admin_users table exists\n    await env.DB.prepare(\n      `CREATE TABLE IF NOT EXISTS admin_users (\n        id TEXT PRIMARY KEY,\n        username TEXT UNIQUE NOT NULL,\n        password_hash TEXT NOT NULL,\n        is_active INTEGER DEFAULT 1,\n        created_at INTEGER,\n        last_login INTEGER\n      )`\n    ).run();\n\n    // Check if admin user exists\n    const existing = await env.DB.prepare(\n      'SELECT id FROM admin_users WHERE username = ?'\n    )\n      .bind('admin')\n      .first();\n\n    if (!existing) {\n      // Create default admin user: admin / password\n      const passwordHash = await hashPassword('password', secretKey);\n      await env.DB.prepare(\n        'INSERT INTO admin_users (id, username, password_hash, created_at) VALUES (?, ?, ?, ?)'\n      )\n        .bind(crypto.randomUUID(), 'admin', passwordHash, Date.now())\n        .run();\n      console.log('Created default admin user: admin / password');\n    }\n  } catch (e) {\n    console.error('Failed to ensure admin user:', e);\n  }\n}\n\n// -----------------------------------------------------------------------------\n// WORKER ENTRY POINT\n// -----------------------------------------------------------------------------\nexport default {\n  async fetch(request: Request, env: Env): Promise<Response> {\n    const url = new URL(request.url);\n    const path = url.pathname;\n    const method = request.method;\n\n    // CORS Headers\n    const corsHeaders = {\n      'Access-Control-Allow-Origin': '*',\n      'Access-Control-Allow-Methods': 'GET, POST, OPTIONS, DELETE',\n      'Access-Control-Allow-Headers': 'Content-Type, Authorization',\n    };\n\n    if (method === 'OPTIONS') {\n      return new Response(null, { headers: corsHeaders });\n    }\n\n    // Use ENCRYPTION_KEY if set, otherwise fallback to API_SECRET for dev convenience\n    const secretKey = env.ENCRYPTION_KEY || env.API_SECRET;\n\n    // Ensure admin_users table and default admin exist\n    await ensureAdminUser(env, secretKey);\n\n    // Ensure allowed_users table exists (Lazy migration for demo purposes)\n    try {\n      await env.DB.prepare(\n        `\n            CREATE TABLE IF NOT EXISTS allowed_users (\n                id TEXT PRIMARY KEY,\n                username TEXT UNIQUE,\n                created_at INTEGER\n            )\n        `\n      ).run();\n    } catch (e) {\n      // Ignore if already exists or concurrent creation issues\n    }\n\n    try {\n      // 1. OAUTH: Redirect to Meta\n      if (path === '/api/auth/login' && method === 'GET') {\n        const source = url.searchParams.get('source') || 'admin';\n        // Pass 'source' in the state parameter so we know where to redirect back to\n        const state = JSON.stringify({ source });\n\n        const metaUrl = `https://www.facebook.com/v19.0/dialog/oauth?client_id=${\n          env.META_APP_ID\n        }&redirect_uri=${env.META_REDIRECT_URI}&state=${encodeURIComponent(\n          state\n        )}&scope=pages_show_list,pages_read_engagement,pages_manage_posts,instagram_basic,instagram_content_publish&response_type=code`;\n        return Response.redirect(metaUrl, 302);\n      }\n\n      // 2. OAUTH: Callback (Handle GET redirect from Facebook)\n      if (path === '/api/auth/callback' && method === 'GET') {\n        const code = url.searchParams.get('code');\n        const error = url.searchParams.get('error');\n        const stateStr = url.searchParams.get('state');\n\n        let redirectBase = '#accounts'; // Default to connected accounts view\n\n        // Check state to see if this came from the onboarding page\n        if (stateStr) {\n          try {\n            const state = JSON.parse(decodeURIComponent(stateStr));\n            if (state.source === 'onboarding') {\n              redirectBase = '#onboarding';\n            }\n          } catch (e) {\n            console.warn('Failed to parse state', e);\n          }\n        }\n\n        // Define fallback frontend URL if env var is missing\n        const frontendUrl = env.FRONTEND_URL || 'http://localhost:3000';\n\n        if (error || !code) {\n          return Response.redirect(\n            `${frontendUrl}/${redirectBase}?error=auth_failed`,\n            302\n          );\n        }\n\n        // Exchange code for token\n        const tokenResp = await fetch(\n          `https://graph.facebook.com/v19.0/oauth/access_token?client_id=${env.META_APP_ID}&redirect_uri=${env.META_REDIRECT_URI}&client_secret=${env.META_APP_SECRET}&code=${code}`\n        );\n        const tokenData: any = await tokenResp.json();\n\n        if (!tokenData.access_token) {\n          return Response.redirect(\n            `${frontendUrl}/${redirectBase}?error=token_failed`,\n            302\n          );\n        }\n\n        // Get Long Lived Token\n        const longTokenResp = await fetch(\n          `https://graph.facebook.com/v19.0/oauth/access_token?grant_type=fb_exchange_token&client_id=${env.META_APP_ID}&client_secret=${env.META_APP_SECRET}&fb_exchange_token=${tokenData.access_token}`\n        );\n        const longTokenData: any = await longTokenResp.json();\n        const finalToken = longTokenData.access_token || tokenData.access_token;\n        const expiry =\n          Date.now() +\n          (longTokenData.expires_in\n            ? longTokenData.expires_in * 1000\n            : 5184000000); // 60 days default\n\n        // Fetch Accounts using the User Token\n        // UPDATED: Fetches instagram_business_account{id,username} to store the handle\n        const accountsResp = await fetch(\n          `https://graph.facebook.com/v19.0/me/accounts?fields=name,access_token,instagram_business_account{id,username}&access_token=${finalToken}`\n        );\n        const accountsData: any = await accountsResp.json();\n\n        let connectedCount = 0;\n        // Fix: Use 'last_updated' instead of 'updated_at' to match SELECT query elsewhere\n        const stmt = env.DB.prepare(\n          `INSERT OR REPLACE INTO accounts (id, owner_name, fb_page_id, fb_page_name, ig_user_id, ig_username, access_token, token_expires_at, status, created_at, last_updated) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`\n        );\n\n        const batch = [];\n        if (accountsData.data) {\n          for (const page of accountsData.data) {\n            // Only add pages that have a linked Instagram Business Account\n            if (page.instagram_business_account) {\n              // Crucial: Encrypt and store the PAGE Access Token, not the User Token.\n              // This ensures we post AS the Page/Business, not as the User.\n              const encryptedPageToken = await encryptToken(\n                page.access_token,\n                secretKey\n              );\n\n              batch.push(\n                stmt.bind(\n                  crypto.randomUUID(),\n                  'Unknown Owner', // In real app, fetch user profile to get real name\n                  page.id,\n                  page.name,\n                  page.instagram_business_account.id,\n                  page.instagram_business_account.username || 'unknown', // Store IG Handle\n                  encryptedPageToken, // Store Encrypted PAGE Token\n                  expiry,\n                  'active',\n                  Date.now(),\n                  Date.now()\n                )\n              );\n              connectedCount++;\n            }\n          }\n        }\n\n        if (batch.length > 0) await env.DB.batch(batch);\n\n        // Redirect back to Frontend with success flag\n        return Response.redirect(\n          `${frontendUrl}/${redirectBase}?success=true&count=${connectedCount}`,\n          302\n        );\n      }\n\n      // 3. GET ACCOUNTS\n      if (path === '/api/accounts' && method === 'GET') {\n        const { results } = await env.DB.prepare(\n          'SELECT id, owner_name, fb_page_name, ig_username, status, last_updated FROM accounts ORDER BY created_at DESC'\n        ).all();\n        return new Response(JSON.stringify(results), {\n          headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n        });\n      }\n\n      // 4. GET DASHBOARD STATS (Real Data)\n      if (path === '/api/dashboard-stats' && method === 'GET') {\n        // Aggregate counts\n        const totalAccounts = await env.DB.prepare(\n          'SELECT count(*) as count FROM accounts'\n        ).first('count');\n        const activeAccounts = await env.DB.prepare(\n          \"SELECT count(*) as count FROM accounts WHERE status = 'active'\"\n        ).first('count');\n        const failedTokens = await env.DB.prepare(\n          \"SELECT count(*) as count FROM accounts WHERE status = 'error'\"\n        ).first('count');\n\n        // Get recent posts count (last 7 days)\n        const oneWeekAgo = Date.now() - 7 * 24 * 60 * 60 * 1000;\n        const postsCount = await env.DB.prepare(\n          'SELECT count(*) as count FROM posts WHERE created_at > ?'\n        )\n          .bind(oneWeekAgo)\n          .first('count');\n\n        return new Response(\n          JSON.stringify({\n            totalAccounts,\n            activeAccounts,\n            failedTokens,\n            postsCount,\n            chartData: [], // TODO: Implement day-by-day aggregation query if D1 allows\n          }),\n          { headers: { ...corsHeaders, 'Content-Type': 'application/json' } }\n        );\n      }\n\n      // 5. GET POSTS (History)\n      if (path === '/api/posts' && method === 'GET') {\n        const { results } = await env.DB.prepare(\n          'SELECT * FROM posts ORDER BY created_at DESC'\n        ).all();\n        return new Response(JSON.stringify(results), {\n          headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n        });\n      }\n\n      // 6. GET LOGS\n      if (path === '/api/logs' && method === 'GET') {\n        const postId = url.searchParams.get('postId');\n        if (!postId) return new Response('Missing postId', { status: 400 });\n\n        // Join with accounts to get names\n        const { results } = await env.DB.prepare(\n          `\n              SELECT l.*, a.fb_page_name as account_name \n              FROM logs l \n              LEFT JOIN accounts a ON l.account_id = a.id \n              WHERE l.post_id = ? \n              ORDER BY l.timestamp DESC\n          `\n        )\n          .bind(postId)\n          .all();\n\n        return new Response(JSON.stringify(results), {\n          headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n        });\n      }\n\n      // 7. UPLOAD IMAGE (R2)\n      if (path === '/api/upload' && method === 'POST') {\n        try {\n          const formData = await request.formData();\n          const file = formData.get('file');\n\n          if (!file || !(file instanceof File)) {\n            return new Response('No valid file uploaded', { status: 400 });\n          }\n\n          const key = `uploads/${crypto.randomUUID()}-${file.name.replace(\n            /[^a-zA-Z0-9.-]/g,\n            ''\n          )}`;\n\n          await env.BUCKET.put(key, file.stream(), {\n            httpMetadata: { contentType: file.type },\n          });\n\n          // Construct Public URL (Assuming Worker serves it at /images/)\n          const publicUrl = `${url.origin}/images/${key}`;\n\n          return new Response(JSON.stringify({ url: publicUrl }), {\n            headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n          });\n        } catch (e: any) {\n          console.error('Upload failed', e);\n          return new Response(JSON.stringify({ error: e.message }), {\n            status: 500,\n            headers: corsHeaders,\n          });\n        }\n      }\n\n      // 8. SERVE IMAGES (R2 Proxy)\n      if (path.startsWith('/images/') && method === 'GET') {\n        const key = path.replace('/images/', '');\n        const object = await env.BUCKET.get(key);\n\n        if (!object) return new Response('Not Found', { status: 404 });\n\n        const headers = new Headers();\n        object.writeHttpMetadata(headers);\n        headers.set('etag', object.httpEtag);\n\n        return new Response(object.body, { headers });\n      }\n\n      // 9. CREATE POST\n      if (path === '/api/posts' && method === 'POST') {\n        const body = (await request.json()) as any;\n        const postId = crypto.randomUUID();\n\n        await env.DB.prepare(\n          'INSERT INTO posts (id, public_image_url, base_caption, status, created_at, success_count, failure_count, total_accounts) VALUES (?, ?, ?, ?, ?, ?, ?, ?)'\n        )\n          .bind(\n            postId,\n            body.imageUrl,\n            body.caption,\n            'pending',\n            Date.now(),\n            0,\n            0,\n            0\n          )\n          .run();\n\n        // Trigger Queue\n        await env.QUEUE.send({ type: 'START_POST', postId });\n\n        return new Response(JSON.stringify({ success: true, postId }), {\n          headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n        });\n      }\n\n      // -----------------------------------------------------------------------\n      // ALLOWLIST / ACCESS CONTROL ENDPOINTS\n      // -----------------------------------------------------------------------\n\n      // Verify User (Client Side)\n      if (path === '/api/verify-user' && method === 'POST') {\n        const { username } = (await request.json()) as any;\n        if (!username) return new Response('Missing username', { status: 400 });\n\n        // Case insensitive check\n        const user = await env.DB.prepare(\n          'SELECT * FROM allowed_users WHERE lower(username) = lower(?)'\n        )\n          .bind(username)\n          .first();\n\n        if (user) {\n          return new Response(\n            JSON.stringify({ verified: true, username: user.username }),\n            { headers: { ...corsHeaders, 'Content-Type': 'application/json' } }\n          );\n        } else {\n          return new Response(JSON.stringify({ verified: false }), {\n            headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n          });\n        }\n      }\n\n      // Get Allowed Users (Admin)\n      if (path === '/api/allowed-users' && method === 'GET') {\n        const { results } = await env.DB.prepare(\n          'SELECT * FROM allowed_users ORDER BY created_at DESC'\n        ).all();\n        return new Response(JSON.stringify(results), {\n          headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n        });\n      }\n\n      // Add Single Allowed User (Admin)\n      if (path === '/api/allowed-users' && method === 'POST') {\n        const { username } = (await request.json()) as any;\n        if (!username) return new Response('Missing username', { status: 400 });\n\n        try {\n          await env.DB.prepare(\n            'INSERT INTO allowed_users (id, username, created_at) VALUES (?, ?, ?)'\n          )\n            .bind(crypto.randomUUID(), username.trim(), Date.now())\n            .run();\n          return new Response(JSON.stringify({ success: true }), {\n            headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n          });\n        } catch (e: any) {\n          // Likely unique constraint violation\n          return new Response(\n            JSON.stringify({\n              success: false,\n              error: 'User likely already exists',\n            }),\n            { headers: { ...corsHeaders, 'Content-Type': 'application/json' } }\n          );\n        }\n      }\n\n      // Delete Allowed User (Admin)\n      if (path === '/api/allowed-users' && method === 'DELETE') {\n        const urlParams = new URL(request.url).searchParams;\n        const id = urlParams.get('id');\n        if (!id) return new Response('Missing id', { status: 400 });\n\n        await env.DB.prepare('DELETE FROM allowed_users WHERE id = ?')\n          .bind(id)\n          .run();\n        return new Response(JSON.stringify({ success: true }), {\n          headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n        });\n      }\n\n      // Bulk Add Allowed Users (Admin - CSV)\n      if (path === '/api/allowed-users/bulk' && method === 'POST') {\n        const { usernames } = (await request.json()) as any;\n        if (!Array.isArray(usernames))\n          return new Response('Invalid data', { status: 400 });\n\n        const stmt = env.DB.prepare(\n          'INSERT OR IGNORE INTO allowed_users (id, username, created_at) VALUES (?, ?, ?)'\n        );\n        const batch = usernames.map((name: string) =>\n          stmt.bind(crypto.randomUUID(), name.trim(), Date.now())\n        );\n\n        if (batch.length > 0) await env.DB.batch(batch);\n\n        return new Response(\n          JSON.stringify({ success: true, count: batch.length }),\n          { headers: { ...corsHeaders, 'Content-Type': 'application/json' } }\n        );\n      }\n\n      // -----------------------------------------------------------------------\n      // ADMIN AUTHENTICATION ENDPOINTS\n      // -----------------------------------------------------------------------\n\n      // Admin Login\n      if (path === '/api/admin/login' && method === 'POST') {\n        const { username, password } = (await request.json()) as any;\n\n        if (!username || !password) {\n          return new Response(\n            JSON.stringify({\n              success: false,\n              error: 'Username and password required',\n            }),\n            {\n              status: 400,\n              headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n            }\n          );\n        }\n\n        try {\n          const user = await env.DB.prepare(\n            'SELECT * FROM admin_users WHERE lower(username) = lower(?) AND is_active = 1'\n          )\n            .bind(username)\n            .first();\n\n          if (user) {\n            const isValid = await verifyPassword(\n              password,\n              user.password_hash,\n              secretKey\n            );\n\n            if (isValid) {\n              // Update last login\n              await env.DB.prepare(\n                'UPDATE admin_users SET last_login = ? WHERE id = ?'\n              )\n                .bind(Date.now(), user.id)\n                .run();\n\n              return new Response(\n                JSON.stringify({\n                  success: true,\n                  username: user.username,\n                  message: 'Login successful',\n                }),\n                {\n                  headers: {\n                    ...corsHeaders,\n                    'Content-Type': 'application/json',\n                  },\n                }\n              );\n            }\n          }\n\n          return new Response(\n            JSON.stringify({ success: false, error: 'Invalid credentials' }),\n            {\n              status: 401,\n              headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n            }\n          );\n        } catch (e: any) {\n          console.error('Login error:', e);\n          return new Response(\n            JSON.stringify({ success: false, error: 'Authentication failed' }),\n            {\n              status: 500,\n              headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n            }\n          );\n        }\n      }\n\n      // Get All Admin Users\n      if (path === '/api/admin/users' && method === 'GET') {\n        try {\n          const { results } = await env.DB.prepare(\n            'SELECT id, username, is_active, created_at, last_login FROM admin_users ORDER BY created_at DESC'\n          ).all();\n\n          return new Response(JSON.stringify(results), {\n            headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n          });\n        } catch (e: any) {\n          return new Response(JSON.stringify({ error: e.message }), {\n            status: 500,\n            headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n          });\n        }\n      }\n\n      // Create New Admin User\n      if (path === '/api/admin/users' && method === 'POST') {\n        const { username, password } = (await request.json()) as any;\n\n        if (!username || !password) {\n          return new Response(\n            JSON.stringify({\n              success: false,\n              error: 'Username and password required',\n            }),\n            {\n              status: 400,\n              headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n            }\n          );\n        }\n\n        if (password.length < 6) {\n          return new Response(\n            JSON.stringify({\n              success: false,\n              error: 'Password must be at least 6 characters',\n            }),\n            {\n              status: 400,\n              headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n            }\n          );\n        }\n\n        try {\n          const passwordHash = await hashPassword(password, secretKey);\n\n          await env.DB.prepare(\n            'INSERT INTO admin_users (id, username, password_hash, created_at) VALUES (?, ?, ?, ?)'\n          )\n            .bind(\n              crypto.randomUUID(),\n              username.trim(),\n              passwordHash,\n              Date.now()\n            )\n            .run();\n\n          return new Response(\n            JSON.stringify({ success: true, message: 'Admin user created' }),\n            { headers: { ...corsHeaders, 'Content-Type': 'application/json' } }\n          );\n        } catch (e: any) {\n          if (e.message?.includes('UNIQUE constraint')) {\n            return new Response(\n              JSON.stringify({\n                success: false,\n                error: 'Username already exists',\n              }),\n              {\n                status: 400,\n                headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n              }\n            );\n          }\n          return new Response(\n            JSON.stringify({ success: false, error: e.message }),\n            {\n              status: 500,\n              headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n            }\n          );\n        }\n      }\n\n      // Update Admin Password\n      if (path === '/api/admin/users/password' && method === 'PUT') {\n        const { username, newPassword } = (await request.json()) as any;\n\n        if (!username || !newPassword || newPassword.length < 6) {\n          return new Response(\n            JSON.stringify({\n              success: false,\n              error: 'Username and new password (min 6 chars) required',\n            }),\n            {\n              status: 400,\n              headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n            }\n          );\n        }\n\n        try {\n          const passwordHash = await hashPassword(newPassword, secretKey);\n\n          const result = await env.DB.prepare(\n            'UPDATE admin_users SET password_hash = ? WHERE lower(username) = lower(?)'\n          )\n            .bind(passwordHash, username)\n            .run();\n\n          if (result.success) {\n            return new Response(\n              JSON.stringify({ success: true, message: 'Password updated' }),\n              {\n                headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n              }\n            );\n          } else {\n            return new Response(\n              JSON.stringify({ success: false, error: 'User not found' }),\n              {\n                status: 404,\n                headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n              }\n            );\n          }\n        } catch (e: any) {\n          return new Response(\n            JSON.stringify({ success: false, error: e.message }),\n            {\n              status: 500,\n              headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n            }\n          );\n        }\n      }\n\n      // Delete Admin User\n      if (path === '/api/admin/users' && method === 'DELETE') {\n        const urlParams = new URL(request.url).searchParams;\n        const id = urlParams.get('id');\n\n        if (!id) {\n          return new Response('Missing id', {\n            status: 400,\n            headers: corsHeaders,\n          });\n        }\n\n        // Prevent deleting the last admin\n        const countResult = await env.DB.prepare(\n          'SELECT count(*) as count FROM admin_users'\n        ).first('count');\n        if (countResult && countResult.count <= 1) {\n          return new Response(\n            JSON.stringify({\n              success: false,\n              error: 'Cannot delete the last admin user',\n            }),\n            {\n              status: 400,\n              headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n            }\n          );\n        }\n\n        try {\n          await env.DB.prepare('DELETE FROM admin_users WHERE id = ?')\n            .bind(id)\n            .run();\n\n          return new Response(JSON.stringify({ success: true }), {\n            headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n          });\n        } catch (e: any) {\n          return new Response(JSON.stringify({ error: e.message }), {\n            status: 500,\n            headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n          });\n        }\n      }\n\n      // Toggle Admin Active Status\n      if (path === '/api/admin/users/toggle' && method === 'PUT') {\n        const { id } = (await request.json()) as any;\n\n        if (!id) {\n          return new Response('Missing id', {\n            status: 400,\n            headers: corsHeaders,\n          });\n        }\n\n        try {\n          // Get current status\n          const user = await env.DB.prepare(\n            'SELECT is_active FROM admin_users WHERE id = ?'\n          )\n            .bind(id)\n            .first();\n\n          if (!user) {\n            return new Response(\n              JSON.stringify({ success: false, error: 'User not found' }),\n              {\n                status: 404,\n                headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n              }\n            );\n          }\n\n          const newStatus = user.is_active ? 0 : 1;\n\n          // Check if trying to deactivate the last active admin\n          if (newStatus === 0) {\n            const activeCount = await env.DB.prepare(\n              'SELECT count(*) as count FROM admin_users WHERE is_active = 1'\n            ).first('count');\n            if (activeCount && activeCount.count <= 1) {\n              return new Response(\n                JSON.stringify({\n                  success: false,\n                  error: 'Cannot deactivate the last active admin',\n                }),\n                {\n                  status: 400,\n                  headers: {\n                    ...corsHeaders,\n                    'Content-Type': 'application/json',\n                  },\n                }\n              );\n            }\n          }\n\n          await env.DB.prepare(\n            'UPDATE admin_users SET is_active = ? WHERE id = ?'\n          )\n            .bind(newStatus, id)\n            .run();\n\n          return new Response(\n            JSON.stringify({ success: true, is_active: newStatus }),\n            { headers: { ...corsHeaders, 'Content-Type': 'application/json' } }\n          );\n        } catch (e: any) {\n          return new Response(JSON.stringify({ error: e.message }), {\n            status: 500,\n            headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n          });\n        }\n      }\n\n      // SYSTEM STATUS ENDPOINT (Real Checks)\n      // Accessible to authenticated admins\n      if (path === '/api/system-status' && method === 'GET') {\n        const status: any = {\n          database: { status: 'unknown', message: '' },\n          storage: { status: 'unknown', message: '' },\n          meta: { status: 'unknown', message: '', appId: '' },\n          env: {},\n        };\n\n        // 1. Check DB\n        try {\n          const start = Date.now();\n          await env.DB.prepare('SELECT 1').first();\n          const latency = Date.now() - start;\n          status.database = {\n            status: 'connected',\n            message: `Latency: ${latency}ms`,\n          };\n        } catch (e: any) {\n          status.database = {\n            status: 'error',\n            message: e.message || 'Connection failed',\n          };\n        }\n\n        // 2. Check R2 Storage\n        try {\n          if (!env.BUCKET) {\n            throw new Error('BUCKET binding not found in environment');\n          }\n          // Try to list 1 object to verify access\n          await env.BUCKET.list({ limit: 1 });\n          status.storage = {\n            status: 'connected',\n            message: 'Bucket accessible',\n          };\n        } catch (e: any) {\n          status.storage = {\n            status: 'error',\n            message: e.message || 'Access denied or misconfigured',\n          };\n        }\n\n        // 3. Check Meta Config\n        if (env.META_APP_ID && env.META_APP_SECRET) {\n          status.meta = {\n            status: 'configured',\n            message: 'Credentials present',\n            appId:\n              env.META_APP_ID.length > 8\n                ? `${env.META_APP_ID.slice(0, 4)}****${env.META_APP_ID.slice(\n                    -4\n                  )}`\n                : '****',\n          };\n        } else {\n          status.meta = {\n            status: 'error',\n            message: 'Missing App ID or Secret',\n            appId: 'N/A',\n          };\n        }\n\n        // 4. Check Env Vars Existence\n        const varsToCheck = [\n          'META_APP_ID',\n          'META_APP_SECRET',\n          'META_REDIRECT_URI',\n          'FRONTEND_URL',\n          'API_SECRET',\n          'ENCRYPTION_KEY',\n        ];\n        varsToCheck.forEach((key) => {\n          status.env[key] = !!(env as any)[key];\n        });\n\n        return new Response(JSON.stringify(status), {\n          headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n        });\n      }\n\n      return new Response('Not Found', { status: 404, headers: corsHeaders });\n    } catch (err: any) {\n      console.error('Global Worker Error:', err);\n      return new Response(\n        JSON.stringify({ error: err.message || 'Internal Server Error' }),\n        { status: 500, headers: corsHeaders }\n      );\n    }\n  },\n\n  // -----------------------------------------------------------------------------\n  // SCHEDULED CRON HANDLER\n  // -----------------------------------------------------------------------------\n  async scheduled(event: any, env: Env, ctx: any): Promise<void> {\n    // 1. Refresh Window: Look for tokens expiring in the next 7 days\n    const REFRESH_WINDOW_MS = 604800000;\n    const now = Date.now();\n    const threshold = now + REFRESH_WINDOW_MS;\n\n    console.log(\n      `[Cron] Starting token refresh check. Looking for expiry < ${new Date(\n        threshold\n      ).toISOString()}`\n    );\n\n    try {\n      // Find active accounts nearing expiry\n      // We select access_token here, which is encrypted\n      const { results } = await env.DB.prepare(\n        \"SELECT id, access_token, fb_page_name FROM accounts WHERE status = 'active' AND token_expires_at < ?\"\n      )\n        .bind(threshold)\n        .all();\n\n      if (results.length === 0) {\n        console.log('[Cron] No accounts need refreshing.');\n        return;\n      }\n\n      console.log(`[Cron] Found ${results.length} accounts to refresh.`);\n\n      // 2. Queue Refresh Jobs\n      for (const acc of results) {\n        await env.QUEUE.send({\n          type: 'REFRESH_TOKEN',\n          accountId: acc.id,\n          currentAccessToken: acc.access_token, // This is encrypted\n          pageName: acc.fb_page_name,\n        });\n      }\n    } catch (e: any) {\n      console.error('[Cron] Error querying database:', e);\n    }\n  },\n\n  // -----------------------------------------------------------------------------\n  // QUEUE CONSUMER\n  // -----------------------------------------------------------------------------\n  async queue(batch: any, env: Env): Promise<void> {\n    for (const message of batch.messages) {\n      const {\n        type,\n        postId,\n        accountId,\n        currentAccessToken,\n        accounts,\n        post,\n        retryCount,\n      } = message.body;\n\n      try {\n        if (type === 'START_POST') {\n          await this.handleStartPost(postId, env);\n        }\n\n        if (type === 'PROCESS_BATCH') {\n          // 'accounts' and 'post' are passed in the message to avoid re-fetching\n          await this.processBatch(accounts, post, env);\n        }\n\n        if (type === 'REFRESH_TOKEN') {\n          await this.handleRefreshToken(accountId, currentAccessToken, env);\n        }\n\n        if (type === 'RETRY_ACCOUNT_POST') {\n          await this.handleRetryAccountPost(postId, accountId, retryCount, env);\n        }\n      } catch (err) {\n        console.error(`Error processing message type ${type}:`, err);\n        message.retry(); // Retry transient failures\n      }\n    }\n  },\n\n  // -----------------------------------------------------------------------------\n  // JOB HANDLERS\n  // -----------------------------------------------------------------------------\n\n  async handleRefreshToken(\n    accountId: string,\n    encryptedCurrentToken: string,\n    env: Env\n  ) {\n    const secretKey = env.ENCRYPTION_KEY || env.API_SECRET;\n    try {\n      // Decrypt token to use it\n      const decryptedToken = await decryptToken(\n        encryptedCurrentToken,\n        secretKey\n      );\n\n      // Exchange current long-lived token for a new one (refresh)\n      const refreshUrl = `https://graph.facebook.com/v19.0/oauth/access_token?grant_type=fb_exchange_token&client_id=${env.META_APP_ID}&client_secret=${env.META_APP_SECRET}&fb_exchange_token=${decryptedToken}`;\n\n      const response = await fetch(refreshUrl);\n      const data: any = await response.json();\n\n      if (data.error || !data.access_token) {\n        throw new Error(\n          data.error?.message || 'Token exchange returned no token'\n        );\n      }\n\n      const newAccessToken = data.access_token;\n      // Expires in comes in seconds, convert to MS. Default 60 days if missing.\n      const expiresInMs = data.expires_in ? data.expires_in * 1000 : 5184000000;\n      const newExpiry = Date.now() + expiresInMs;\n\n      // Encrypt the new token before saving\n      const encryptedNewToken = await encryptToken(newAccessToken, secretKey);\n\n      // Update DB\n      await env.DB.prepare(\n        \"UPDATE accounts SET access_token = ?, token_expires_at = ?, last_updated = ?, status = 'active' WHERE id = ?\"\n      )\n        .bind(encryptedNewToken, newExpiry, Date.now(), accountId)\n        .run();\n\n      console.log(`[RefreshToken] Success for account ${accountId}`);\n    } catch (error: any) {\n      console.error(`[RefreshToken] Failed for account ${accountId}:`, error);\n\n      // If refresh fails, mark as error so user knows to reconnect\n      await env.DB.prepare(\n        \"UPDATE accounts SET status = 'error', last_updated = ? WHERE id = ?\"\n      )\n        .bind(Date.now(), accountId)\n        .run();\n    }\n  },\n\n  async handleStartPost(postId: string, env: Env) {\n    // 1. Get Post Data\n    const post = await env.DB.prepare('SELECT * FROM posts WHERE id = ?')\n      .bind(postId)\n      .first();\n    if (!post) return;\n\n    // 2. Get All Active Accounts (includes encrypted access_token)\n    const { results: accounts } = await env.DB.prepare(\n      'SELECT * FROM accounts WHERE status = ?'\n    )\n      .bind('active')\n      .all();\n\n    // Update total count and status to 'in_progress'\n    await env.DB.prepare(\n      'UPDATE posts SET total_accounts = ?, status = ? WHERE id = ?'\n    )\n      .bind(accounts.length, 'in_progress', postId)\n      .run();\n\n    // 3. Split into chunks of 100\n    // Requirement: Divide into 100 accounts for 15 min.\n    // We queue each batch with a delay of (index * 15 minutes).\n    const chunkSize = 100;\n    const delayPerChunkSeconds = 15 * 60; // 15 minutes in seconds\n\n    for (let i = 0; i < accounts.length; i += chunkSize) {\n      const chunk = accounts.slice(i, i + chunkSize);\n      const batchIndex = Math.floor(i / chunkSize);\n      const delay = batchIndex * delayPerChunkSeconds;\n\n      // Send batch to queue with delay\n      await env.QUEUE.send(\n        {\n          type: 'PROCESS_BATCH',\n          postId,\n          accounts: chunk, // Pass full account objects to avoid re-fetching in consumer\n          post, // Pass post data\n        },\n        {\n          delaySeconds: delay, // 0, 900, 1800, etc.\n        }\n      );\n    }\n  },\n\n  async processBatch(accounts: any[], post: any, env: Env) {\n    const secretKey = env.ENCRYPTION_KEY || env.API_SECRET;\n\n    for (const account of accounts) {\n      // Requirement: \"each account should be posted between 2-3 seconds gap\"\n      // Random delay between 2000ms and 3000ms\n      const delay = Math.floor(Math.random() * 1000) + 2000;\n      await new Promise((resolve) => setTimeout(resolve, delay));\n\n      // Attempt post with retry logic enabled (retryCount start = 0)\n      await this.attemptPost(account, post, secretKey, env, 0);\n    }\n\n    // Check completion\n    await this.checkCampaignCompletion(post.id, env);\n  },\n\n  async handleRetryAccountPost(\n    postId: string,\n    accountId: string,\n    retryCount: number,\n    env: Env\n  ) {\n    const post = await env.DB.prepare('SELECT * FROM posts WHERE id = ?')\n      .bind(postId)\n      .first();\n    const account = await env.DB.prepare('SELECT * FROM accounts WHERE id = ?')\n      .bind(accountId)\n      .first();\n\n    if (!post || !account) {\n      console.error(\n        'Retry failed: Data not found for post/account',\n        postId,\n        accountId\n      );\n      return;\n    }\n\n    const secretKey = env.ENCRYPTION_KEY || env.API_SECRET;\n    await this.attemptPost(account, post, secretKey, env, retryCount);\n\n    await this.checkCampaignCompletion(postId, env);\n  },\n\n  // -----------------------------------------------------------------------------\n  // SHARED POSTING LOGIC\n  // -----------------------------------------------------------------------------\n\n  async attemptPost(\n    account: any,\n    post: any,\n    secretKey: string,\n    env: Env,\n    retryCount: number\n  ) {\n    // Apply Anti-Spam Variations (Shuffle hashtags, inject emojis)\n    const finalCaption = processCaption(\n      post.base_caption,\n      account.fb_page_name\n    );\n\n    try {\n      const metaIds = await this.publishToMeta(\n        account,\n        post,\n        finalCaption,\n        secretKey\n      );\n\n      // Log Success\n      await env.DB.prepare(\n        'INSERT INTO logs (post_id, account_id, final_caption, meta_post_id, status, timestamp) VALUES (?, ?, ?, ?, ?, ?)'\n      )\n        .bind(post.id, account.id, finalCaption, metaIds, 'success', Date.now())\n        .run();\n\n      await env.DB.prepare(\n        'UPDATE posts SET success_count = success_count + 1 WHERE id = ?'\n      )\n        .bind(post.id)\n        .run();\n    } catch (err: any) {\n      const MAX_RETRIES = 5;\n      if (retryCount < MAX_RETRIES) {\n        // Schedule Retry\n        const nextRetry = retryCount + 1;\n        const backoffSeconds = Math.pow(2, nextRetry) * 30; // 60s, 120s, 240s, 480s, 960s\n\n        console.log(\n          `[Retry] Queuing retry #${nextRetry} for ${account.fb_page_name} (Delay: ${backoffSeconds}s). Reason: ${err.message}`\n        );\n\n        await env.QUEUE.send(\n          {\n            type: 'RETRY_ACCOUNT_POST',\n            postId: post.id,\n            accountId: account.id,\n            retryCount: nextRetry,\n          },\n          { delaySeconds: backoffSeconds }\n        );\n      } else {\n        // Fail\n        console.error(\n          `[Failure] Max retries reached for ${account.fb_page_name}.`\n        );\n\n        await env.DB.prepare(\n          'INSERT INTO logs (post_id, account_id, final_caption, error_message, status, timestamp) VALUES (?, ?, ?, ?, ?, ?)'\n        )\n          .bind(\n            post.id,\n            account.id,\n            finalCaption,\n            `Max Retries Exceeded: ${err.message}`,\n            'failed',\n            Date.now()\n          )\n          .run();\n\n        await env.DB.prepare(\n          'UPDATE posts SET failure_count = failure_count + 1 WHERE id = ?'\n        )\n          .bind(post.id)\n          .run();\n      }\n    }\n  },\n\n  async publishToMeta(\n    account: any,\n    post: any,\n    caption: string,\n    secretKey: string\n  ): Promise<string> {\n    // Decrypt Token\n    let accessToken;\n    try {\n      accessToken = await decryptToken(account.access_token, secretKey);\n    } catch (e) {\n      throw new Error('Token decryption failed');\n    }\n\n    // 1. Create Media Container (Instagram)\n    const containerUrl = `https://graph.facebook.com/v19.0/${account.ig_user_id}/media`;\n    const containerResp = await fetch(containerUrl, {\n      method: 'POST',\n      body: new URLSearchParams({\n        image_url: post.public_image_url,\n        caption: caption,\n        access_token: accessToken,\n      }),\n    });\n    const containerData: any = await containerResp.json();\n\n    if (containerData.error || !containerData.id) {\n      throw new Error(\n        'IG Container: ' + (containerData.error?.message || 'Unknown error')\n      );\n    }\n\n    // 2. Publish Media (Instagram)\n    const publishUrl = `https://graph.facebook.com/v19.0/${account.ig_user_id}/media_publish`;\n    const publishResp = await fetch(publishUrl, {\n      method: 'POST',\n      body: new URLSearchParams({\n        creation_id: containerData.id,\n        access_token: accessToken,\n      }),\n    });\n    const publishData: any = await publishResp.json();\n\n    if (publishData.error || !publishData.id) {\n      throw new Error(\n        'IG Publish: ' + (publishData.error?.message || 'Unknown error')\n      );\n    }\n\n    // 3. Publish to Facebook Page\n    const fbUrl = `https://graph.facebook.com/v19.0/${account.fb_page_id}/photos`;\n    const fbResp = await fetch(fbUrl, {\n      method: 'POST',\n      body: new URLSearchParams({\n        url: post.public_image_url,\n        caption: caption,\n        access_token: accessToken,\n        published: 'true',\n      }),\n    });\n    const fbData: any = await fbResp.json();\n\n    return `IG:${publishData.id}, FB:${fbData.id || 'failed'}`;\n  },\n\n  async checkCampaignCompletion(postId: string, env: Env) {\n    const stats = await env.DB.prepare(\n      'SELECT success_count, failure_count, total_accounts FROM posts WHERE id = ?'\n    )\n      .bind(postId)\n      .first();\n    if (\n      stats &&\n      stats.success_count + stats.failure_count >= stats.total_accounts\n    ) {\n      await env.DB.prepare(\n        \"UPDATE posts SET status = 'completed', completed_at = ? WHERE id = ? AND status != 'completed'\"\n      )\n        .bind(Date.now(), postId)\n        .run();\n    }\n  },\n};\n", "import type { Middleware } from \"./common\";\n\nconst drainBody: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} finally {\n\t\ttry {\n\t\t\tif (request.body !== null && !request.bodyUsed) {\n\t\t\t\tconst reader = request.body.getReader();\n\t\t\t\twhile (!(await reader.read()).done) {}\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.error(\"Failed to drain the unused request body.\", e);\n\t\t}\n\t}\n};\n\nexport default drainBody;\n", "import type { Middleware } from \"./common\";\n\ninterface JsonError {\n\tmessage?: string;\n\tname?: string;\n\tstack?: string;\n\tcause?: JsonError;\n}\n\nfunction reduceError(e: any): JsonError {\n\treturn {\n\t\tname: e?.name,\n\t\tmessage: e?.message ?? String(e),\n\t\tstack: e?.stack,\n\t\tcause: e?.cause === undefined ? undefined : reduceError(e.cause),\n\t};\n}\n\n// See comment in `bundle.ts` for details on why this is needed\nconst jsonError: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} catch (e: any) {\n\t\tconst error = reduceError(e);\n\t\treturn Response.json(error, {\n\t\t\tstatus: 500,\n\t\t\theaders: { \"MF-Experimental-Error-Stack\": \"true\" },\n\t\t});\n\t}\n};\n\nexport default jsonError;\n", "\t\t\t\timport worker, * as OTHER_EXPORTS from \"/Applications/Projects/social-media-manager/backend/worker.ts\";\n\t\t\t\timport * as __MIDDLEWARE_0__ from \"/Users/manju/.npm/_npx/32026684e21afda6/node_modules/wrangler/templates/middleware/middleware-ensure-req-body-drained.ts\";\nimport * as __MIDDLEWARE_1__ from \"/Users/manju/.npm/_npx/32026684e21afda6/node_modules/wrangler/templates/middleware/middleware-miniflare3-json-error.ts\";\n\n\t\t\t\texport * from \"/Applications/Projects/social-media-manager/backend/worker.ts\";\n\t\t\t\tconst MIDDLEWARE_TEST_INJECT = \"__INJECT_FOR_TESTING_WRANGLER_MIDDLEWARE__\";\n\t\t\t\texport const __INTERNAL_WRANGLER_MIDDLEWARE__ = [\n\t\t\t\t\t\n\t\t\t\t\t__MIDDLEWARE_0__.default,__MIDDLEWARE_1__.default\n\t\t\t\t]\n\t\t\t\texport default worker;", "export type Awaitable<T> = T | Promise<T>;\n// TODO: allow dispatching more events?\nexport type Dispatcher = (\n\ttype: \"scheduled\",\n\tinit: { cron?: string }\n) => Awaitable<void>;\n\nexport type IncomingRequest = Request<\n\tunknown,\n\tIncomingRequestCfProperties<unknown>\n>;\n\nexport interface MiddlewareContext {\n\tdispatch: Dispatcher;\n\tnext(request: IncomingRequest, env: any): Awaitable<Response>;\n}\n\nexport type Middleware = (\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tmiddlewareCtx: MiddlewareContext\n) => Awaitable<Response>;\n\nconst __facade_middleware__: Middleware[] = [];\n\n// The register functions allow for the insertion of one or many middleware,\n// We register internal middleware first in the stack, but have no way of controlling\n// the order that addMiddleware is run in service workers so need an internal function.\nexport function __facade_register__(...args: (Middleware | Middleware[])[]) {\n\t__facade_middleware__.push(...args.flat());\n}\nexport function __facade_registerInternal__(\n\t...args: (Middleware | Middleware[])[]\n) {\n\t__facade_middleware__.unshift(...args.flat());\n}\n\nfunction __facade_invokeChain__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tmiddlewareChain: Middleware[]\n): Awaitable<Response> {\n\tconst [head, ...tail] = middlewareChain;\n\tconst middlewareCtx: MiddlewareContext = {\n\t\tdispatch,\n\t\tnext(newRequest, newEnv) {\n\t\t\treturn __facade_invokeChain__(newRequest, newEnv, ctx, dispatch, tail);\n\t\t},\n\t};\n\treturn head(request, env, ctx, middlewareCtx);\n}\n\nexport function __facade_invoke__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tfinalMiddleware: Middleware\n): Awaitable<Response> {\n\treturn __facade_invokeChain__(request, env, ctx, dispatch, [\n\t\t...__facade_middleware__,\n\t\tfinalMiddleware,\n\t]);\n}\n", "// This loads all middlewares exposed on the middleware object and then starts\n// the invocation chain. The big idea is that we can add these to the middleware\n// export dynamically through wrangler, or we can potentially let users directly\n// add them as a sort of \"plugin\" system.\n\nimport ENTRY, { __INTERNAL_WRANGLER_MIDDLEWARE__ } from \"/Applications/Projects/social-media-manager/backend/.wrangler/tmp/bundle-OXXgyv/middleware-insertion-facade.js\";\nimport { __facade_invoke__, __facade_register__, Dispatcher } from \"/Users/manju/.npm/_npx/32026684e21afda6/node_modules/wrangler/templates/middleware/common.ts\";\nimport type { WorkerEntrypointConstructor } from \"/Applications/Projects/social-media-manager/backend/.wrangler/tmp/bundle-OXXgyv/middleware-insertion-facade.js\";\n\n// Preserve all the exports from the worker\nexport * from \"/Applications/Projects/social-media-manager/backend/.wrangler/tmp/bundle-OXXgyv/middleware-insertion-facade.js\";\n\nclass __Facade_ScheduledController__ implements ScheduledController {\n\treadonly #noRetry: ScheduledController[\"noRetry\"];\n\n\tconstructor(\n\t\treadonly scheduledTime: number,\n\t\treadonly cron: string,\n\t\tnoRetry: ScheduledController[\"noRetry\"]\n\t) {\n\t\tthis.#noRetry = noRetry;\n\t}\n\n\tnoRetry() {\n\t\tif (!(this instanceof __Facade_ScheduledController__)) {\n\t\t\tthrow new TypeError(\"Illegal invocation\");\n\t\t}\n\t\t// Need to call native method immediately in case uncaught error thrown\n\t\tthis.#noRetry();\n\t}\n}\n\nfunction wrapExportedHandler(worker: ExportedHandler): ExportedHandler {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn worker;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\tconst fetchDispatcher: ExportedHandlerFetchHandler = function (\n\t\trequest,\n\t\tenv,\n\t\tctx\n\t) {\n\t\tif (worker.fetch === undefined) {\n\t\t\tthrow new Error(\"Handler does not export a fetch() function.\");\n\t\t}\n\t\treturn worker.fetch(request, env, ctx);\n\t};\n\n\treturn {\n\t\t...worker,\n\t\tfetch(request, env, ctx) {\n\t\t\tconst dispatcher: Dispatcher = function (type, init) {\n\t\t\t\tif (type === \"scheduled\" && worker.scheduled !== undefined) {\n\t\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\t\tDate.now(),\n\t\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t\t() => {}\n\t\t\t\t\t);\n\t\t\t\t\treturn worker.scheduled(controller, env, ctx);\n\t\t\t\t}\n\t\t\t};\n\t\t\treturn __facade_invoke__(request, env, ctx, dispatcher, fetchDispatcher);\n\t\t},\n\t};\n}\n\nfunction wrapWorkerEntrypoint(\n\tklass: WorkerEntrypointConstructor\n): WorkerEntrypointConstructor {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn klass;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\t// `extend`ing `klass` here so other RPC methods remain callable\n\treturn class extends klass {\n\t\t#fetchDispatcher: ExportedHandlerFetchHandler<Record<string, unknown>> = (\n\t\t\trequest,\n\t\t\tenv,\n\t\t\tctx\n\t\t) => {\n\t\t\tthis.env = env;\n\t\t\tthis.ctx = ctx;\n\t\t\tif (super.fetch === undefined) {\n\t\t\t\tthrow new Error(\"Entrypoint class does not define a fetch() function.\");\n\t\t\t}\n\t\t\treturn super.fetch(request);\n\t\t};\n\n\t\t#dispatcher: Dispatcher = (type, init) => {\n\t\t\tif (type === \"scheduled\" && super.scheduled !== undefined) {\n\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\tDate.now(),\n\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t() => {}\n\t\t\t\t);\n\t\t\t\treturn super.scheduled(controller);\n\t\t\t}\n\t\t};\n\n\t\tfetch(request: Request<unknown, IncomingRequestCfProperties>) {\n\t\t\treturn __facade_invoke__(\n\t\t\t\trequest,\n\t\t\t\tthis.env,\n\t\t\t\tthis.ctx,\n\t\t\t\tthis.#dispatcher,\n\t\t\t\tthis.#fetchDispatcher\n\t\t\t);\n\t\t}\n\t};\n}\n\nlet WRAPPED_ENTRY: ExportedHandler | WorkerEntrypointConstructor | undefined;\nif (typeof ENTRY === \"object\") {\n\tWRAPPED_ENTRY = wrapExportedHandler(ENTRY);\n} else if (typeof ENTRY === \"function\") {\n\tWRAPPED_ENTRY = wrapWorkerEntrypoint(ENTRY);\n}\nexport default WRAPPED_ENTRY;\n"],
  "mappings": "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",
  "names": []
}
